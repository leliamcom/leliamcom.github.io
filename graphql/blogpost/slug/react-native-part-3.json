{"author":{"avatar":"/assets/32x32_avatar.jpg","name":"Liam","tagline":"Make people great again!"},"data":"\nIn react native AwesomeProject example, it gets bundle files with 2 options:\n\n1. Load from development server\n2. Load from pre-bundled file on disk\n\n## Hybrid options?\n\nThe react native default options looks good, but not good enough.\n\nWe would like it to load from development server asynchronously, and load from pre-bundled file on disk when the new bundled file is not ready yet.\n\nGood news - with some enhance on the AppDelegate.m file that come with the AwesomeProject, it can be archieved!\n\n## Coding\n\n[View AppDelegate.m at Github](https://gist.github.com/nghenglim/46391331d443165d9d53)\n\nFirst declare the variable, and set the filepath default store and get from the document directory.\n\n~~~ c\nNSArray   *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);\nNSString  *documentsDirectory = [paths objectAtIndex:0];\nNSString  *filePath = [NSString stringWithFormat:@\"%@/%@\", documentsDirectory,@\"index.ios.bundle\"];\n~~~\n\nUnder OPTION 2, asynchronously download file from server. Detect if the file exist in document directory, if the new bundle file exist, load from the document directory. Else, load from the pre-bundled file on the disk:\n\n~~~ c\ndispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{\n  NSURL  *url = [NSURL URLWithString:@\"http://localhost:8081/index.ios.bundle?platform=ios&dev=true\"];\n  NSData *urlData = [NSData dataWithContentsOfURL:url];\n  if ( urlData )\n  {\n    //saving is done on main thread\n    dispatch_async(dispatch_get_main_queue(), ^{\n      [urlData writeToFile:filePath atomically:YES];\n    });\n  }\n});\n\nBOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:filePath];\nif (fileExists) {\n  jsCodeLocation = [[NSURL alloc] initFileURLWithPath:filePath];\n} else {\n  jsCodeLocation = [[NSBundle mainBundle] URLForResource:@\"main\" withExtension:@\"jsbundle\"];\n}\n~~~\n\n## Some note\n\nThis method still have many more enhancement can be done, however its enough to showcase the possibility of react native to asynchronously load file from server, and use the new bundle file when it is ready.\n    ","id":"ea395046-3eb7-462c-b995-053a16c4ca23","bannerUrl":"/assets/2015101000.png","coverUrl":"/assets/2015101000.png","postedAt":"2015-10-16T16:00:00.000Z","tags":["react-native","ios"],"title":"React Native Part 3","typeCode":1}
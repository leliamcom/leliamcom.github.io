<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8">
  <title>SaltStack Vagrant Part 3</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="fb:app_id" content="1678943848891569">

  <link rel="icon" href="/favicon.ico">
  <meta name="description" content="Author: Liam, Date: Jan 30, 2016

Last week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. All SaltStack Article
">
  <meta property="og:type" content="article">
  <meta property="og:image" content="https://www.leliam.com/assets/thumb-150-2016011600.png">
  <meta property="og:image:url" content="https://www.leliam.com/assets/thumb-150-2016011600.png">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500"></noscript>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-47309606-3"></script>
  <!-- <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-47309606-3');
  </script> -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1976d2">
<link rel="stylesheet" href="styles.13c4283d7ffd60f209aa.css"><style ng-transition="leliam">h1[_ngcontent-sc0] {
  font-size: 1.2em;
  color: #999;
  margin-bottom: 0;
}
h2[_ngcontent-sc0] {
  font-size: 2em;
  margin-top: 0;
  padding-top: 0;
}
nav[_ngcontent-sc0]   a[_ngcontent-sc0] {
  padding: 5px 10px;
  text-decoration: none;
  margin-top: 10px;
  display: inline-block;
  background-color: #eee;
  border-radius: 4px;
}
nav[_ngcontent-sc0]   a[_ngcontent-sc0]:visited, a[_ngcontent-sc0]:link {
  color: #607D8B;
}
nav[_ngcontent-sc0]   a[_ngcontent-sc0]:hover {
  color: #039be5;
  background-color: #CFD8DC;
}
nav[_ngcontent-sc0]   a.active[_ngcontent-sc0] {
  color: #039be5;
}
body[_ngcontent-sc0] {
  height: 100%;
}</style><style ng-transition="leliam">.toolbar-fill-remaining-space[_ngcontent-sc2] {
  
  -ms-flex: 1 1 auto;
      flex: 1 1 auto;
}
a[_ngcontent-sc2] {
  text-decoration: none;
}
@media only screen and (max-width: 600px) {
  .minwidth-600[_ngcontent-sc2] {
    display: none !important;
  }
}
@media only screen and (max-width: 700px) {
  .minwidth-700[_ngcontent-sc2] {
    display: none !important;
  }
}
@media only screen and (min-width: 601px) {
  .maxwidth-600[_ngcontent-sc2] {
    display: none !important;
  }
}
@media only screen and (min-width: 701px) {
  .maxwidth-700[_ngcontent-sc2] {
    display: none !important;
  }
}</style><style ng-transition="leliam"></style><style ng-transition="leliam">@media screen and (-ms-high-contrast:active){.mat-toolbar{outline:solid 1px}}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media (max-width:599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}</style><style ng-transition="leliam">.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:2px;outline:0}.mat-menu-panel:not([class*=mat-elevation-z]){box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}@media screen and (-ms-high-contrast:active){.mat-menu-panel{outline:solid 1px}}.mat-menu-content{padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;position:relative}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item-submenu-trigger{padding-right:32px}.mat-menu-item-submenu-trigger::after{width:0;height:0;border-style:solid;border-width:5px 0 5px 5px;border-color:transparent transparent transparent currentColor;content:'';display:inline-block;position:absolute;top:50%;right:16px;transform:translateY(-50%)}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}[dir=rtl] .mat-menu-item-submenu-trigger::after{right:auto;left:16px;transform:rotateY(180deg) translateY(-50%)}.mat-menu-panel.ng-animating .mat-menu-item-submenu-trigger{pointer-events:none}button.mat-menu-item{width:100%}.mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}</style><style ng-transition="leliam">.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:88px;line-height:36px;padding:0 16px;border-radius:2px;overflow:visible}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:1}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{transition:none;opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:1}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:88px;line-height:36px;padding:0 16px;border-radius:2px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:1}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button:not([class*=mat-elevation-z]){box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-raised-button:not([disabled]):active:not([class*=mat-elevation-z]){box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mat-raised-button[disabled]{box-shadow:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button:not([class*=mat-elevation-z]){box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12)}.mat-flat-button:not([class*=mat-elevation-z]){box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12)}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:88px;line-height:36px;padding:0 16px;border-radius:2px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:1}.mat-fab::-moz-focus-inner{border:0}.mat-fab:not([class*=mat-elevation-z]){box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab:not([disabled]):active:not([class*=mat-elevation-z]){box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mat-fab[disabled]{box-shadow:none}.mat-fab:not([class*=mat-elevation-z]){box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.mat-fab:not([disabled]):active:not([class*=mat-elevation-z]){box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:88px;line-height:36px;padding:0 16px;border-radius:2px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:1}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab:not([class*=mat-elevation-z]){box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab:not([disabled]):active:not([class*=mat-elevation-z]){box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mat-mini-fab[disabled]{box-shadow:none}.mat-mini-fab:not([class*=mat-elevation-z]){box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.mat-mini-fab:not([disabled]):active:not([class*=mat-elevation-z]){box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-focus-overlay{background-color:rgba(0,0,0,.12);border-radius:inherit;opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media screen and (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:rgba(255,255,255,.5)}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media screen and (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}</style><style ng-transition="leliam">.mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1,1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}</style><style ng-transition="leliam">@import url('https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css');
.blogpost-inner[_ngcontent-sc21]     img {
  max-width: 100%
}
.banner-img[_ngcontent-sc21] {
  -o-object-fit: contain;
     object-fit: contain;
}
.td-avatar[_ngcontent-sc21] {
  padding-right: 10px;
}
.avatar-small[_ngcontent-sc21] {
  height: 40px;
  width: 40px;
  border-radius: 50%;
  -ms-flex-negative: 0;
      flex-shrink: 0;
}
a.tag[_ngcontent-sc21] {
  margin-right: 5px;
}
.banner-image-container[_ngcontent-sc21] {
  text-align: center;
}
.banner-image-container[_ngcontent-sc21]   img[_ngcontent-sc21] {
  max-width: 100%;
  max-height: 300px;
}
  .fb-comments:before {
  content: "Loading Facebook Comments Plugin...";
}
  .fb-comments[fb-xfbml-state="rendered"]:before {
  content: "";
}</style><style ng-transition="leliam">.mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2s linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4s;animation-timing-function:cubic-bezier(.35,0,.25,1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10s cubic-bezier(.87,.03,.33,1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.60617px;transform:rotate(0)}12.5%{stroke-dashoffset:56.54867px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.54867px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.60617px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.60617px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.54867px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.54867px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.60617px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.60617px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.54867px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.54867px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.60617px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.60617px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.54867px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.54867px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.60617px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}</style><meta property="og:url" content="https://www.leliam.com/blogpost/dfd8816b-5205-4468-ab70-a34ecaf68d96"><meta property="og:title" content="SaltStack Vagrant Part 3"><meta property="og:description" content="Author: Liam, Date: Jan 30, 2016

Last week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. All SaltStack Article
"></head>
<body>
  <div id="fb-root"></div>
  <app-root _nghost-sc0="" ng-version="6.0.7"><!----><div _ngcontent-sc0="" class="mat-typography"><app-nav _ngcontent-sc0="" _nghost-sc2=""><div _ngcontent-sc2="" class="mat-typography"><mat-toolbar _ngcontent-sc2="" class="mat-toolbar mat-toolbar-single-row"><mat-menu _ngcontent-sc2="" class="ng-tns-c6-0 ng-star-inserted"><!----></mat-menu><a _ngcontent-sc2="" mat-button="" routerlink="/" class="mat-button _mat-animation-noopable" tabindex="0" aria-disabled="false" href="/"><span class="mat-button-wrapper"><h3 _ngcontent-sc2="">Le Liam</h3></span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc2="" class="minwidth-600 mat-button _mat-animation-noopable" mat-button="" routerlink="/" routerlinkactive="mat-primary" tabindex="0" aria-disabled="false" href="/"><span class="mat-button-wrapper">Home</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc2="" mat-button="" routerlink="/tags" routerlinkactive="mat-primary" class="mat-button _mat-animation-noopable" tabindex="0" aria-disabled="false" href="/tags"><span class="mat-button-wrapper">Tags</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc2="" class="minwidth-600 mat-button _mat-animation-noopable" mat-button="" routerlink="/blogposts" routerlinkactive="mat-primary" tabindex="0" aria-disabled="false" href="/blogposts"><span class="mat-button-wrapper">Blogposts</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc2="" class="minwidth-700 mat-button _mat-animation-noopable" mat-button="" routerlink="/contact" routerlinkactive="mat-primary" tabindex="0" aria-disabled="false" href="/contact"><span class="mat-button-wrapper">Contact</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><span _ngcontent-sc2="" class="toolbar-fill-remaining-space"></span><button _ngcontent-sc2="" aria-haspopup="true" aria-label="More" class="maxwidth-700 mat-icon-button mat-primary _mat-animation-noopable" color="primary" mat-icon-button=""><span class="mat-button-wrapper"><mat-icon _ngcontent-sc2="" class="mat-icon" role="img" svgicon="more_vert" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fit="" preserveAspectRatio="xMidYMid meet" focusable="false">
<path d="M0 0h24v24H0z" fill="none"></path>
<path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path>
</svg></mat-icon></span><div class="mat-button-ripple mat-ripple mat-button-ripple-round" matripple=""></div><div class="mat-button-focus-overlay"></div></button></mat-toolbar></div></app-nav><app-status-bar _ngcontent-sc0="" _nghost-sc3=""><!----></app-status-bar><router-outlet _ngcontent-sc0=""></router-outlet><app-blogpost _nghost-sc21="" class="ng-star-inserted"><!----><!----><!----><!----><div _ngcontent-sc21="" class="ng-star-inserted"><!----><div _ngcontent-sc21="" class="ng-star-inserted"><div _ngcontent-sc21="" class="main-bg" style="padding-bottom:20px"><div _ngcontent-sc21="" class="container"><br _ngcontent-sc21=""><table _ngcontent-sc21=""><tbody _ngcontent-sc21=""><tr _ngcontent-sc21=""><td _ngcontent-sc21="" class="td-avatar" rowspan="2"><div _ngcontent-sc21="" class="avatar-small" style="background-image:url('/assets/32x32_avatar.jpg');background-size:cover;"></div></td><td _ngcontent-sc21="">Liam</td></tr><tr _ngcontent-sc21=""><td _ngcontent-sc21="" style="color:rgba(0,0,0,.54)"><small _ngcontent-sc21="">Jan 30, 2016</small></td></tr></tbody></table><!----><div _ngcontent-sc21="" class="banner-image-container ng-star-inserted"><img _ngcontent-sc21="" alt="blogpost banner image" src="/assets/2016011600.png"></div><br _ngcontent-sc21=""><h1 _ngcontent-sc21=""> SaltStack Vagrant Part 3 </h1><div _ngcontent-sc21="" class="blogpost-inner"><p>Last week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. <a href="https://www.leliam.com/tag/salt">All SaltStack Article</a></p>
<h2>What is Salt Formulas</h2>
<p>Formulas are pre-written Salt States. All official Salt Formulas are found as separate Git repositories in the "saltstack-formulas" organization on GitHub: <a href="https://github.com/saltstack-formulas">https://github.com/saltstack-formulas</a></p>
<h2>Objective</h2>
<p>This week objective will be installing NodeJS 5.4.0 from binary with salt formula.</p>
<p>The standard way of installing salt-formula can be found at <a href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html">https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html</a>. However, I will use my own way here.</p>
<h2>Server Structure</h2>
<pre class="hljs"><code># vagrant sync folder
config.vm.synced_folder "salt/root/", "/srv/salt/"
config.vm.synced_folder "salt/pillar/", "/srv/pillar/"
</code></pre>
<pre class="hljs"><code>- /srv/
  - pillar/  # Unlike state tree, pillar data is only available for the targeted minion specified by the matcher type.
  - salt/  # All the configuration for the minion to run
    - node/ # node formula folder
</code></pre>
<h2>Svn Export from Github</h2>
<p>My favourite Github hack: (replacing tree/master with trunk)</p>
<pre class="hljs"><code><span class="hljs-built_in">cd</span> salt/root
svn <span class="hljs-built_in">export</span> https://github.com/saltstack-formulas/node-formula/trunk/node
</code></pre>
<pre class="hljs"><code>#salt/root.top.sls
base:
  '*':
    - node
</code></pre>
<pre class="hljs"><code># pillar/node/init.sls
node:
  version: 5.4.0
  checksum: f037e2734f52b9de63e6d4a4e80756477b843e6f106e0be05591a16b71ec2bd0
  install_from_binary: True
</code></pre>
<pre class="hljs"><code># pillar/top.sls
base:
  '*':
    - node
</code></pre>
<p>If you try <code>salt-call --local state.highstate</code> you probably will get an error now. Why?</p>
<h2>Grains</h2>
<p>Salt comes with an interface to derive information about the underlying system. This is called the grains interface, because it presents salt with grains of information. Grains are collected for the operating system, domain name, IP address, kernel, OS type, memory, and many other system properties.</p>
<p>As of the time I'm writing, <a href="https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja">https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja</a> line 19-28 is missing CentOS config for the grains.os (most of saltstack formula comes with Ubuntu), so add Centos config</p>
<pre class="hljs"><code>'Centos': {
    'node_pkg': 'nodejs',
    'npm_pkg': 'nodejs' if pillar_get('node:install_from_ppa') else 'npm',
},
</code></pre>
<p>How to see my os value is grains? Just run the script below can look for os, for me the value is CentOS</p>
<pre class="hljs"><code>sudo salt-call --local grains.items
</code></pre>
<p>Grains can be customized in minion config file or at <code>/etc/salt/grains</code>, however normally using its default value is enough.</p>
<h2>End Result</h2>
<p>It should successfully install node version <code>5.4.0</code> and verify against checksum <code>f037e2734f52b9de6......</code>.</p>
<p>Now run <code>salt-call --local state.highstate</code> and run <code>node -v</code> to verify, it should output <code>v5.4.0</code>.</p>
<h2>This is it</h2>
<p>So the basic concept of saltstack to work with masterless vagrant should be covered from part 1 to part 3. After knowing the basic concept it should be relatively easy to google search for salt related article and create a salt script that fits your need.</p>
</div><!----><a _ngcontent-sc21="" class="tag mat-stroked-button _mat-animation-noopable ng-star-inserted" mat-stroked-button="" tabindex="0" aria-disabled="false" href="/tag/salt"><span class="mat-button-wrapper">salt</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc21="" class="tag mat-stroked-button _mat-animation-noopable ng-star-inserted" mat-stroked-button="" tabindex="0" aria-disabled="false" href="/tag/configuration-management"><span class="mat-button-wrapper">configuration-management</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-sc21="" class="tag mat-stroked-button _mat-animation-noopable ng-star-inserted" mat-stroked-button="" tabindex="0" aria-disabled="false" href="/tag/vagrant"><span class="mat-button-wrapper">vagrant</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a></div></div><div _ngcontent-sc21="" align="middle" class="container" style="padding:20px 0"><h2 _ngcontent-sc21="">Comments</h2><!----><button _ngcontent-sc21="" color="primary" mat-stroked-button="" class="mat-stroked-button mat-primary _mat-animation-noopable ng-star-inserted"><span class="mat-button-wrapper">Load Comments</span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></button><div _ngcontent-sc21="" id="fbCommentArea"></div></div></div></div></app-blogpost></div><!----></app-root>
<script type="text/javascript" src="runtime.01e8443cb11eb050d776.js"></script><script type="text/javascript" src="polyfills.ff2bf6f47cc2a735f015.js"></script><script type="text/javascript" src="main.4527d1d7fa48c8268146.js" defer></script>

<script id="leliam-state" type="application/json">{&q;blogpost-from_server&q;:true,&q;blogpost-blogpost&q;:{&q;author&q;:{&q;avatar&q;:&q;/assets/32x32_avatar.jpg&q;,&q;name&q;:&q;Liam&q;,&q;tagline&q;:&q;Make people great again!&q;},&q;description&q;:&q;\nLast week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. [All SaltStack Article](https://www.leliam.com/tag/salt)\n    &q;,&q;data&q;:&q;\nLast week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. [All SaltStack Article](https://www.leliam.com/tag/salt)\n\n## What is Salt Formulas\nFormulas are pre-written Salt States. All official Salt Formulas are found as separate Git repositories in the \&q;saltstack-formulas\&q; organization on GitHub: [https://github.com/saltstack-formulas](https://github.com/saltstack-formulas)\n\n## Objective\nThis week objective will be installing NodeJS 5.4.0 from binary with salt formula.\n\nThe standard way of installing salt-formula can be found at [https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html](https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html). However, I will use my own way here.\n\n## Server Structure\n~~~ ruby\n# vagrant sync folder\nconfig.vm.synced_folder \&q;salt/root/\&q;, \&q;/srv/salt/\&q;\nconfig.vm.synced_folder \&q;salt/pillar/\&q;, \&q;/srv/pillar/\&q;\n~~~\n\n~~~ ruby\n- /srv/\n  - pillar/  # Unlike state tree, pillar data is only available for the targeted minion specified by the matcher type.\n  - salt/  # All the configuration for the minion to run\n    - node/ # node formula folder\n~~~\n\n## Svn Export from Github\nMy favourite Github hack: (replacing tree/master with trunk)\n\n~~~ bash\ncd salt/root\nsvn export https://github.com/saltstack-formulas/node-formula/trunk/node\n~~~\n\n~~~ ruby\n#salt/root.top.sls\nbase:\n  &s;*&s;:\n    - node\n~~~\n\n~~~ ruby\n# pillar/node/init.sls\nnode:\n  version: 5.4.0\n  checksum: f037e2734f52b9de63e6d4a4e80756477b843e6f106e0be05591a16b71ec2bd0\n  install_from_binary: True\n~~~\n\n~~~ ruby\n# pillar/top.sls\nbase:\n  &s;*&s;:\n    - node\n~~~\n\nIf you try `salt-call --local state.highstate` you probably will get an error now. Why?\n\n## Grains\nSalt comes with an interface to derive information about the underlying system. This is called the grains interface, because it presents salt with grains of information. Grains are collected for the operating system, domain name, IP address, kernel, OS type, memory, and many other system properties.\n\nAs of the time I&s;m writing, [https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja](https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja) line 19-28 is missing CentOS config for the grains.os (most of saltstack formula comes with Ubuntu), so add Centos config\n\n~~~ ruby\n&s;Centos&s;: {\n    &s;node_pkg&s;: &s;nodejs&s;,\n    &s;npm_pkg&s;: &s;nodejs&s; if pillar_get(&s;node:install_from_ppa&s;) else &s;npm&s;,\n},\n~~~\n\nHow to see my os value is grains? Just run the script below can look for os, for me the value is CentOS\n~~~ ruby\nsudo salt-call --local grains.items\n~~~\n\nGrains can be customized in minion config file or at `/etc/salt/grains`, however normally using its default value is enough.\n\n## End Result\nIt should successfully install node version `5.4.0` and verify against checksum `f037e2734f52b9de6......`.\n\nNow run `salt-call --local state.highstate` and run `node -v` to verify, it should output `v5.4.0`.\n\n## This is it\nSo the basic concept of saltstack to work with masterless vagrant should be covered from part 1 to part 3. After knowing the basic concept it should be relatively easy to google search for salt related article and create a salt script that fits your need.\n    &q;,&q;id&q;:&q;dfd8816b-5205-4468-ab70-a34ecaf68d96&q;,&q;bannerUrl&q;:&q;/assets/2016011600.png&q;,&q;coverUrl&q;:&q;/assets/thumb-150-2016011600.png&q;,&q;postedAt&q;:&q;2016-01-29T16:00:00.000Z&q;,&q;tags&q;:[&q;salt&q;,&q;configuration-management&q;,&q;vagrant&q;],&q;title&q;:&q;SaltStack Vagrant Part 3&q;,&q;typeCode&q;:1,&q;slug&q;:&q;saltstack-vagrant-part-3-@b6OoeoGspf0hA4TOO50PsfY&q;},&q;blogpost-blogHtml&q;:&q;&l;p&g;Last week we talked about how to make use pillar to create users in our master-less salt server. Today will be about how to use salt-formula and grains. &l;a href=\&q;https://www.leliam.com/tag/salt\&q;&g;All SaltStack Article&l;/a&g;&l;/p&g;\n&l;h2&g;What is Salt Formulas&l;/h2&g;\n&l;p&g;Formulas are pre-written Salt States. All official Salt Formulas are found as separate Git repositories in the &a;quot;saltstack-formulas&a;quot; organization on GitHub: &l;a href=\&q;https://github.com/saltstack-formulas\&q;&g;https://github.com/saltstack-formulas&l;/a&g;&l;/p&g;\n&l;h2&g;Objective&l;/h2&g;\n&l;p&g;This week objective will be installing NodeJS 5.4.0 from binary with salt formula.&l;/p&g;\n&l;p&g;The standard way of installing salt-formula can be found at &l;a href=\&q;https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html\&q;&g;https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html&l;/a&g;. However, I will use my own way here.&l;/p&g;\n&l;h2&g;Server Structure&l;/h2&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;# vagrant sync folder\nconfig.vm.synced_folder &a;quot;salt/root/&a;quot;, &a;quot;/srv/salt/&a;quot;\nconfig.vm.synced_folder &a;quot;salt/pillar/&a;quot;, &a;quot;/srv/pillar/&a;quot;\n&l;/code&g;&l;/pre&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;- /srv/\n  - pillar/  # Unlike state tree, pillar data is only available for the targeted minion specified by the matcher type.\n  - salt/  # All the configuration for the minion to run\n    - node/ # node formula folder\n&l;/code&g;&l;/pre&g;\n&l;h2&g;Svn Export from Github&l;/h2&g;\n&l;p&g;My favourite Github hack: (replacing tree/master with trunk)&l;/p&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;&l;span class=\&q;hljs-built_in\&q;&g;cd&l;/span&g; salt/root\nsvn &l;span class=\&q;hljs-built_in\&q;&g;export&l;/span&g; https://github.com/saltstack-formulas/node-formula/trunk/node\n&l;/code&g;&l;/pre&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;#salt/root.top.sls\nbase:\n  &s;*&s;:\n    - node\n&l;/code&g;&l;/pre&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;# pillar/node/init.sls\nnode:\n  version: 5.4.0\n  checksum: f037e2734f52b9de63e6d4a4e80756477b843e6f106e0be05591a16b71ec2bd0\n  install_from_binary: True\n&l;/code&g;&l;/pre&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;# pillar/top.sls\nbase:\n  &s;*&s;:\n    - node\n&l;/code&g;&l;/pre&g;\n&l;p&g;If you try &l;code&g;salt-call --local state.highstate&l;/code&g; you probably will get an error now. Why?&l;/p&g;\n&l;h2&g;Grains&l;/h2&g;\n&l;p&g;Salt comes with an interface to derive information about the underlying system. This is called the grains interface, because it presents salt with grains of information. Grains are collected for the operating system, domain name, IP address, kernel, OS type, memory, and many other system properties.&l;/p&g;\n&l;p&g;As of the time I&s;m writing, &l;a href=\&q;https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja\&q;&g;https://github.com/saltstack-formulas/node-formula/blob/master/node/map.jinja&l;/a&g; line 19-28 is missing CentOS config for the grains.os (most of saltstack formula comes with Ubuntu), so add Centos config&l;/p&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;&s;Centos&s;: {\n    &s;node_pkg&s;: &s;nodejs&s;,\n    &s;npm_pkg&s;: &s;nodejs&s; if pillar_get(&s;node:install_from_ppa&s;) else &s;npm&s;,\n},\n&l;/code&g;&l;/pre&g;\n&l;p&g;How to see my os value is grains? Just run the script below can look for os, for me the value is CentOS&l;/p&g;\n&l;pre class=\&q;hljs\&q;&g;&l;code&g;sudo salt-call --local grains.items\n&l;/code&g;&l;/pre&g;\n&l;p&g;Grains can be customized in minion config file or at &l;code&g;/etc/salt/grains&l;/code&g;, however normally using its default value is enough.&l;/p&g;\n&l;h2&g;End Result&l;/h2&g;\n&l;p&g;It should successfully install node version &l;code&g;5.4.0&l;/code&g; and verify against checksum &l;code&g;f037e2734f52b9de6......&l;/code&g;.&l;/p&g;\n&l;p&g;Now run &l;code&g;salt-call --local state.highstate&l;/code&g; and run &l;code&g;node -v&l;/code&g; to verify, it should output &l;code&g;v5.4.0&l;/code&g;.&l;/p&g;\n&l;h2&g;This is it&l;/h2&g;\n&l;p&g;So the basic concept of saltstack to work with masterless vagrant should be covered from part 1 to part 3. After knowing the basic concept it should be relatively easy to google search for salt related article and create a salt script that fits your need.&l;/p&g;\n&q;,&q;blogpost-showType&q;:3,&q;blogpost-errorMessage&q;:&q;&q;,&q;blogpost-postslug&q;:&q;saltstack-vagrant-part-3-@b6OoeoGspf0hA4TOO50PsfY&q;,&q;blogpost-shortener&q;:&q;6OoeoGspf0hA4TOO50PsfY&q;}</script></body></html>
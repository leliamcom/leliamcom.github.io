<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=css/global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.ico rel=icon type=image/png> <link href=client/main.963202101.css rel=stylesheet><link href=client/[slug].06d393e7.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Rewriting the blog in sveltejs sapper</title> <meta content="Author: Liam, Date: 02 Jan, 2020\n In my previous blogpost I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91/100, which can still be improved.
To solve this, I will have to rewrite it in SvelteJS, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.
" name=description> <meta content=article name=og:type> <meta content=https://leliam.com/blogposts/rewriting-the-blog-in-sveltejs-sapper-@7jnR89DGyH1tRLdznWMTTN name=og:url> <meta content="Rewriting the blog in sveltejs sapper" name=og:title> <meta content="In my previous blogpost I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91/100, which can still be improved.\nTo solve this, I will have to rewrite it in SvelteJS, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.\n" name=og:description><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div style="min-height:calc(100vh - 48px)"> <nav aria-label="main navigation" class="svelte-1dif8ux navbar" role=navigation> <div class=navbar-brand> <a href=/ class="svelte-1dif8ux navbar-item" style=margin:5px><div class="is-4 subtitle">Le Liam</div></a> <a href=/ class="svelte-1dif8ux navbar-item">Home</a> <a href=/tags class="svelte-1dif8ux navbar-item">Tags</a> <a href=/blogposts class="svelte-1dif8ux navbar-item is-active">Blogposts</a> <a href=/contact class="svelte-1dif8ux navbar-item">Contact</a> </div> </nav> <main> <div class="container is-fluid"> <div class=media style="margin:25px 0"> <div class=media-left> <figure class="image is-48x48"> <img alt="Author avatar" loading=lazy src=/assets/32x32_avatar.jpg class=is-rounded> </figure> </div> <div class=media-content> <p class="is-4 title">Liam</p> <p class="subtitle is-6">02 Jan, 2020</p> </div> </div> <div style="margin:0 0 25px"> <img alt="blogpost banner" loading=lazy src=/assets/svelte.png style="margin:0 auto;display:block"> </div> <h3 class=title>Rewriting the blog in sveltejs sapper</h3> <div class="content svelte-nn94v0"> <h2>Rewriting the blog in sveltejs sapper</h2> <p>In my <a href=https://www.leliam.com/blogposts/angular-is-great-again-making-ssr-app-with-high-performance-in-google-lighthouse-@5Ypgkc83siF9W3A4SDPsac>previous blogpost</a> I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91/100, which can still be improved.</p> <p>To solve this, I will have to rewrite it in <a href=https://svelte.dev/ >SvelteJS</a>, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.</p> <h2>Compare to previous</h2> <ul> <li>Angular frontend: will be replaced svelteJS</li> <li>Material Design: replaced with Bulma CSS for lower size</li> <li>Koa backend: will be removed as I'm not really hosting it as something like wordpress</li> <li>Minio as document backend: will be removed as I'm not really hosting it as something like wordpress</li> <li>fancy things like hero video: removed to save user bandwidth</li> </ul> <h2>End Result</h2> <p>Now I write the blog directly in git repo, just like how I used to do it in Jekyll.</p> <p>And the development and compiling is really easy, below are part of my package.json, by running <code>npm run export</code>, I already generated folder that I can upload to my github page.</p> <pre class=hljs><code>"dev": "HOST=localhost PORT=8080 sapper dev",
"build": "sapper build --legacy",
"export": "sapper export --legacy",
</code></pre> <h2>The Performance</h2> <p>To test the performance locally, I have written a simple server to mimic github page behavior. Below is the performace result during the time I written this blogpost.</p> <p>Note that the performance(93) will be improved once I host it in github page due to http/2.</p> <ul> <li>lighthouse audit desktop simulated 4g 4x cpu slowdown <img alt=20191231_performance_lighthouse_desktop_simulated_slow_4g_4x_cpu_slowdown loading=lazy src=/assets/20191231_performance_lighthouse_desktop_simulated_slow_4g_4x_cpu_slowdown.png></li> <li>lighthouse audit mobile simulated 4g 4x cpu slowdown <img alt=20191231_performance_lighthouse_mobile_simulated_slow_4g_4x_cpu_slowdown loading=lazy src=/assets/20191231_performance_lighthouse_mobile_simulated_slow_4g_4x_cpu_slowdown.png></li> </ul> <h3>Metrics in homepage</h3> <ul> <li>CSS: 19.05 KB transferred (mainly from bulma css)</li> <li>JS: 16.35 KB transferred</li> <li>HTML: 4.98 KB transferred</li> <li>FONT: 22.71 KB transferred <img alt=20190102_resource_all loading=lazy src=/assets/20190102_resource_all.png></li> </ul> <h2>Conclusion</h2> <p>I'm quite happy with the current setup.</p> <ul> <li>Compare with Angular SSR, the performance is a lot better and the bundler size is a lot smaller.</li> <li>Compare with Jekyll, the github page feels like a SPA and able to use a lot of frontend component with npm + rollup</li> </ul> </div> </div> </main> </div> <footer style=height:48px;padding:10px> <div class="content has-text-centered"> <a href=/privacy-policy>privacy policy</a> · ©2018-2020 Le Liam · <a href=/terms-of-service>TOS</a> </div> </footer></div> <script crossorigin=anonymous src="https://polyfill.io/v3/polyfill.min.js?features=fetch%2CPromise"></script> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{slug:"rewriting-the-blog-in-sveltejs-sapper-@7jnR89DGyH1tRLdznWMTTN",title:"Rewriting the blog in sveltejs sapper",description:"\u003Cp\u003EIn my \u003Ca href=\"https:\u002F\u002Fwww.leliam.com\u002Fblogposts\u002Fangular-is-great-again-making-ssr-app-with-high-performance-in-google-lighthouse-@5Ypgkc83siF9W3A4SDPsac\"\u003Eprevious blogpost\u003C\u002Fa\u003E I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91\u002F100, which can still be improved.\u003C\u002Fp\u003E\n\u003Cp\u003ETo solve this, I will have to rewrite it in \u003Ca href=\"https:\u002F\u002Fsvelte.dev\u002F\"\u003ESvelteJS\u003C\u002Fa\u003E, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.\u003C\u002Fp\u003E\n",banner:"\u002Fassets\u002Fsvelte.png",author:{avatar:"\u002Fassets\u002F32x32_avatar.jpg",name:"Liam"},data:"\u003Ch2\u003ERewriting the blog in sveltejs sapper\u003C\u002Fh2\u003E\n\u003Cp\u003EIn my \u003Ca href=\"https:\u002F\u002Fwww.leliam.com\u002Fblogposts\u002Fangular-is-great-again-making-ssr-app-with-high-performance-in-google-lighthouse-@5Ypgkc83siF9W3A4SDPsac\"\u003Eprevious blogpost\u003C\u002Fa\u003E I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91\u002F100, which can still be improved.\u003C\u002Fp\u003E\n\u003Cp\u003ETo solve this, I will have to rewrite it in \u003Ca href=\"https:\u002F\u002Fsvelte.dev\u002F\"\u003ESvelteJS\u003C\u002Fa\u003E, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.\u003C\u002Fp\u003E\n\u003Ch2\u003ECompare to previous\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003EAngular frontend: will be replaced svelteJS\u003C\u002Fli\u003E\n\u003Cli\u003EMaterial Design: replaced with Bulma CSS for lower size\u003C\u002Fli\u003E\n\u003Cli\u003EKoa backend: will be removed as I'm not really hosting it as something like wordpress\u003C\u002Fli\u003E\n\u003Cli\u003EMinio as document backend: will be removed as I'm not really hosting it as something like wordpress\u003C\u002Fli\u003E\n\u003Cli\u003Efancy things like hero video: removed to save user bandwidth\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2\u003EEnd Result\u003C\u002Fh2\u003E\n\u003Cp\u003ENow I write the blog directly in git repo, just like how I used to do it in Jekyll.\u003C\u002Fp\u003E\n\u003Cp\u003EAnd the development and compiling is really easy, below are part of my package.json, by running \u003Ccode\u003Enpm run export\u003C\u002Fcode\u003E, I already generated folder that I can upload to my github page.\u003C\u002Fp\u003E\n\u003Cpre class=\"hljs\"\u003E\u003Ccode\u003E&quot;dev&quot;: &quot;HOST=localhost PORT=8080 sapper dev&quot;,\n&quot;build&quot;: &quot;sapper build --legacy&quot;,\n&quot;export&quot;: &quot;sapper export --legacy&quot;,\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EThe Performance\u003C\u002Fh2\u003E\n\u003Cp\u003ETo test the performance locally, I have written a simple server to mimic github page behavior. Below is the performace result during the time I written this blogpost.\u003C\u002Fp\u003E\n\u003Cp\u003ENote that the performance(93) will be improved once I host it in github page due to http\u002F2.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Elighthouse audit desktop simulated 4g 4x cpu slowdown \u003Cimg src=\"\u002Fassets\u002F20191231_performance_lighthouse_desktop_simulated_slow_4g_4x_cpu_slowdown.png\" alt=\"20191231_performance_lighthouse_desktop_simulated_slow_4g_4x_cpu_slowdown\" loading=\"lazy\"\u003E\u003C\u002Fli\u003E\n\u003Cli\u003Elighthouse audit mobile simulated 4g 4x cpu slowdown \u003Cimg src=\"\u002Fassets\u002F20191231_performance_lighthouse_mobile_simulated_slow_4g_4x_cpu_slowdown.png\" alt=\"20191231_performance_lighthouse_mobile_simulated_slow_4g_4x_cpu_slowdown\" loading=\"lazy\"\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3\u003EMetrics in homepage\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003ECSS: 19.05 KB transferred (mainly from bulma css)\u003C\u002Fli\u003E\n\u003Cli\u003EJS: 16.35 KB transferred\u003C\u002Fli\u003E\n\u003Cli\u003EHTML: 4.98 KB transferred\u003C\u002Fli\u003E\n\u003Cli\u003EFONT: 22.71 KB transferred\n\u003Cimg src=\"\u002Fassets\u002F20190102_resource_all.png\" alt=\"20190102_resource_all\" loading=\"lazy\"\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2\u003EConclusion\u003C\u002Fh2\u003E\n\u003Cp\u003EI'm quite happy with the current setup.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECompare with Angular SSR, the performance is a lot better and the bundler size is a lot smaller.\u003C\u002Fli\u003E\n\u003Cli\u003ECompare with Jekyll, the github page feels like a SPA and able to use a lot of frontend component with npm + rollup\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",postedAt:"02 Jan, 2020",metaDescription:"In my previous blogpost I had written on how I create a SSR app in angular. The result is quite good, however the bundle size is still quite big due to angular runtime, and the performance score in lighthouse is only 91\u002F100, which can still be improved.\nTo solve this, I will have to rewrite it in SvelteJS, which shift a lot of work during compile time instead of browser, and surgically updates the DOM when the state of your app changes.\n"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.7b48616d.js"}catch(e){main="/client/legacy/client.c16ef45d.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <script> function trim(text, val) {
		return text.replace(new RegExp('^'+val+'+|'+val+'+$','g'), '');
	}
	if (document.title === "Not Found") {
		let paths = trim(window.location.pathname, "/").split("-@");
		if (paths.length > 1) {
			fetch("/blogposts/shortener-" + paths[paths.length - 1] + ".json")
			.then((data) => {
				return data.json()
			})
			.then((data) => {
				window.location.href = "/blogposts/" + data.slug;
			})
			.catch((err) => {
				window.location.href = "/";
			})
		} else {
			window.location.href = "/";
		}
	} </script> 
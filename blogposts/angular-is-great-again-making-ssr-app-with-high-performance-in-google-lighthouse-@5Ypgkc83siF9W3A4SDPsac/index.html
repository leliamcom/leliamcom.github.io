<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=css/global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.ico rel=icon type=image/png> <link href=client/main.2444170631.css rel=stylesheet><link href=client/[slug].227aa286.css rel=stylesheet><link href=client/app.900f9ceb.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Angular is great again - making SSR app with high performance in google lighthouse</title> <meta content="Author: Liam, Date: 18 Jul, 2018\n While exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.
Using google lighthouse to test it, resulted in 91/100 performance, 100/100 progressive web app, 100/100 accessibility, 100/100 best practices, 100/100 SEO, with the main bundle size in 775.7KB.
" name=description> <meta content=article name=og:type> <meta content=https://leliam.com/blogposts/angular-is-great-again-making-ssr-app-with-high-performance-in-google-lighthouse-@5Ypgkc83siF9W3A4SDPsac name=og:url> <meta content="Angular is great again - making SSR app with high performance in google lighthouse" name=og:title> <meta content="While exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.\nUsing google lighthouse to test it, resulted in 91/100 performance, 100/100 progressive web app, 100/100 accessibility, 100/100 best practices, 100/100 SEO, with the main bundle size in 775.7KB.\n" name=og:description><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div style="min-height:calc(100vh - 48px)"> <nav aria-label="main navigation" class="svelte-1dif8ux navbar" role=navigation> <div class=navbar-brand> <a href=/ class="svelte-1dif8ux navbar-item" style=margin:5px><div class="is-4 subtitle">Le Liam</div></a> <a href=/ class="svelte-1dif8ux navbar-item">Home</a> <a href=/tags class="svelte-1dif8ux navbar-item">Tags</a> <a href=/blogposts class="svelte-1dif8ux navbar-item is-active">Blogposts</a> <a href=/contact class="svelte-1dif8ux navbar-item">Contact</a> </div> </nav> <main> <div class="container is-fluid"> <div class=media style="margin:25px 0"> <div class=media-left> <figure class="image is-48x48"> <img alt="Author avatar" loading=lazy src=/assets/32x32_avatar.jpg class=is-rounded> </figure> </div> <div class=media-content> <p class="is-4 title">Liam</p> <p class="subtitle is-6">18 Jul, 2018</p> </div> </div> <div style="margin:0 0 25px"> <img alt="blogpost banner" loading=lazy src=/assets/2018071800.png style="margin:0 auto;display:block"> </div> <h3 class=title>Angular is great again - making SSR app with high performance in google lighthouse</h3> <div class="content svelte-nn94v0"> <p>While exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.</p> <p>Using google lighthouse to test it, resulted in 91/100 performance, 100/100 progressive web app, 100/100 accessibility, 100/100 best practices, 100/100 SEO, with the main bundle size in 775.7KB.</p> <h2>Hosting the blog</h2> <p>The amazing part of using angular universal is that it has ability to compile all the page to static html. Making SSR and hosting on github available (or any CDN).</p> <h2>Tech Stack</h2> <ul> <li>Backend using koa2 + graphql: nodejs is useful that we can use same language with frontend and graphql let us have high confidence in calling the api from frontend</li> <li>Database with Postgres: Quite enough for starting, unless it aim to become as big as medium.com then cassandra will be better</li> <li>Frontend with Angular Universal: Unlike react, Angular is a framework that give opinion on what you should use, therefore all developers can share the same understanding and less debate.</li> </ul> <h2>My Blog in Local Environment</h2> <p><img alt="leliam.com in localhost" loading=lazy src=/assets/2018071803.png> Just to show that it actually is not just a normal static webpage, but instead is being compiled to static webpage from a normal app!</p> <h2>Initial app before optimizing</h2> <p><img alt="initial app before optimizing" loading=lazy src=/assets/2018071801.png></p> <ul> <li>Initially the app will be big which has 2.47MB for our main bundle.js, therefore you will go through several step of optimization</li> </ul> <ol> <li>use lazy loading that seperate our route to different chunk</li> <li>use tree shaking to reduce size of some package (such as highlight.js)</li> <li>reducing package size such as moment that use a lot of locale</li> </ol> <h2>After optimizing main bundle</h2> <p><img alt="after optimizing main bundle" loading=lazy src=/assets/2018071802.png></p> <ul> <li>You can see that the bundle size reduced a lot!!</li> </ul> <h2>Further enhance for lighthouse performance</h2> <p>Even with the reduce of main bundle size, the lighthouse performance is still quite bad, to increase the lighthouse performance, we will have to:</p> <ol> <li>preload some non critical css</li> <li>solve the flickering issue by using transfer state</li> <li>make plugins such as facebook comment to only load when needed</li> <li>reduce useless html rendering such as my login button which is not needed when hosting on github</li> <li>finally make the bundle.js to defer loading so that it won't interrupt the initial DOM rendering.</li> </ol> <h2>Conclusion</h2> <p>Is quite happy with the Angular Universal, I am looking forward to the release of Angular version 7.0 that will possibly reduce the core.js size.</p> <p>The server-side rendering and progressive web app is becoming more important since we will not only support mobile, but potentially AR and VR device, angular is finally a great option in building a high quality PWA!</p> </div> </div> </main> </div> <footer style=height:48px;padding:10px> <div class="content has-text-centered"> <a href=/privacy-policy>privacy policy</a> · ©2018-2020 Le Liam · <a href=/terms-of-service>TOS</a> </div> </footer></div> <script crossorigin=anonymous src="https://polyfill.io/v3/polyfill.min.js?features=fetch%2CPromise"></script> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{slug:"angular-is-great-again-making-ssr-app-with-high-performance-in-google-lighthouse-@5Ypgkc83siF9W3A4SDPsac",title:"Angular is great again - making SSR app with high performance in google lighthouse",description:"\u003Cp\u003EWhile exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.\u003C\u002Fp\u003E\n\u003Cp\u003EUsing google lighthouse to test it, resulted in 91\u002F100 performance, 100\u002F100 progressive web app, 100\u002F100 accessibility, 100\u002F100 best practices, 100\u002F100 SEO, with the main bundle size in 775.7KB.\u003C\u002Fp\u003E\n",banner:"\u002Fassets\u002F2018071800.png",author:{avatar:"\u002Fassets\u002F32x32_avatar.jpg",name:"Liam"},data:"\u003Cp\u003EWhile exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.\u003C\u002Fp\u003E\n\u003Cp\u003EUsing google lighthouse to test it, resulted in 91\u002F100 performance, 100\u002F100 progressive web app, 100\u002F100 accessibility, 100\u002F100 best practices, 100\u002F100 SEO, with the main bundle size in 775.7KB.\u003C\u002Fp\u003E\n\u003Ch2\u003EHosting the blog\u003C\u002Fh2\u003E\n\u003Cp\u003EThe amazing part of using angular universal is that it has ability to compile all the page to static html. Making SSR and hosting on github available (or any CDN).\u003C\u002Fp\u003E\n\u003Ch2\u003ETech Stack\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003EBackend using koa2 + graphql: nodejs is useful that we can use same language with frontend and graphql let us have high confidence in calling the api from frontend\u003C\u002Fli\u003E\n\u003Cli\u003EDatabase with Postgres: Quite enough for starting, unless it aim to become as big as medium.com then cassandra will be better\u003C\u002Fli\u003E\n\u003Cli\u003EFrontend with Angular Universal: Unlike react, Angular is a framework that give opinion on what you should use, therefore all developers can share the same understanding and less debate.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2\u003EMy Blog in Local Environment\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fassets\u002F2018071803.png\" alt=\"leliam.com in localhost\" loading=\"lazy\"\u003E\nJust to show that it actually is not just a normal static webpage, but instead is being compiled to static webpage from a normal app!\u003C\u002Fp\u003E\n\u003Ch2\u003EInitial app before optimizing\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fassets\u002F2018071801.png\" alt=\"initial app before optimizing\" loading=\"lazy\"\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EInitially the app will be big which has 2.47MB for our main bundle.js, therefore you will go through several step of optimization\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Col\u003E\n\u003Cli\u003Euse lazy loading that seperate our route to different chunk\u003C\u002Fli\u003E\n\u003Cli\u003Euse tree shaking to reduce size of some package (such as highlight.js)\u003C\u002Fli\u003E\n\u003Cli\u003Ereducing package size such as moment that use a lot of locale\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2\u003EAfter optimizing main bundle\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fassets\u002F2018071802.png\" alt=\"after optimizing main bundle\" loading=\"lazy\"\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EYou can see that the bundle size reduced a lot!!\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2\u003EFurther enhance for lighthouse performance\u003C\u002Fh2\u003E\n\u003Cp\u003EEven with the reduce of main bundle size, the lighthouse performance is still quite bad, to increase the lighthouse performance, we will have to:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003Epreload some non critical css\u003C\u002Fli\u003E\n\u003Cli\u003Esolve the flickering issue by using transfer state\u003C\u002Fli\u003E\n\u003Cli\u003Emake plugins such as facebook comment to only load when needed\u003C\u002Fli\u003E\n\u003Cli\u003Ereduce useless html rendering such as my login button which is not needed when hosting on github\u003C\u002Fli\u003E\n\u003Cli\u003Efinally make the bundle.js to defer loading so that it won't interrupt the initial DOM rendering.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2\u003EConclusion\u003C\u002Fh2\u003E\n\u003Cp\u003EIs quite happy with the Angular Universal, I am looking forward to the release of Angular version 7.0 that will possibly reduce the core.js size.\u003C\u002Fp\u003E\n\u003Cp\u003EThe server-side rendering and progressive web app is becoming more important since we will not only support mobile, but potentially AR and VR device, angular is finally a great option in building a high quality PWA!\u003C\u002Fp\u003E\n",postedAt:"18 Jul, 2018",metaDescription:"While exploring the option on making a blog with content management system, I give a try on making use of koa2 + Postgres + Angular and the result turns out quite good.\nUsing google lighthouse to test it, resulted in 91\u002F100 performance, 100\u002F100 progressive web app, 100\u002F100 accessibility, 100\u002F100 best practices, 100\u002F100 SEO, with the main bundle size in 775.7KB.\n"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.ef7c4807.js"}catch(e){main="/client/legacy/client.994d7ee4.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 
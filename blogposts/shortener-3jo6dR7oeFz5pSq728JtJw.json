{"slug":"goroutine-@3jo6dR7oeFz5pSq728JtJw","title":"Goroutine","description":"<p>A goroutine is a lightweight thread managed by the Go runtime to support concurrency. It is considered a better mechanism than nodejs event event loop or normal thread.</p>\n","banner":"/assets/2015091900.jpg","author":{"avatar":"/assets/32x32_avatar.jpg","name":"Liam"},"data":"<p>A goroutine is a lightweight thread managed by the Go runtime to support concurrency. It is considered a better mechanism than nodejs event event loop or normal thread.</p>\n<h2>Goroutine vs Java thread</h2>\n<p>Quoting from <a href=\"http://tleyden.github.io/blog/2014/10/30/goroutines-vs-threads/\">this blog</a></p>\n<ul>\n<li>On Java you can run 1000’s or tens of 1000’s threads. On Go you can run hundreds of thousands or millions of goroutines.</li>\n<li>Java threads map directly to OS threads, and are relatively heavyweight. Part of the reason they are heavyweight is their rather large fixed stack size. This caps the number of them you can run in a single VM due to the increasing memory overhead.</li>\n<li>Go OTOH has a segmented stack that grows as needed. They are “Green threads”, which means the Go runtime does the scheduling, not the OS. The runtime multiplexes the goroutines onto real OS threads, the number of which is controlled by GOMAXPROCS. Typically you’ll want to set this to the number of cores on your system, to maximize potential parellelism.</li>\n</ul>\n<h2>Example of goroutine</h2>\n<p>The example can be found at <a href=\"https://gobyexample.com/goroutines\">gobyexample</a>. The how it work internally can refer to this\n<a href=\"http://www.goinggo.net/2015/02/scheduler-tracing-in-go.html\">&quot;example&quot;</a>.</p>\n<p>To summarise, golang achieve concurrency with the implementation of goroutine and <a href=\"https://gobyexample.com/channels\">channel</a>. Goroutine acts as task worker while channel let them achieve &quot;<a href=\"https://golang.org/doc/codewalk/sharemem/\">Share Memory By Communicating</a>&quot;.</p>\n<h2>Advantage of goroutine</h2>\n<ul>\n<li>\n<p>No callback hell, example at <a href=\"http://stackoverflow.com/a/23709882\">stackoverflow</a></p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">//nodejs (if not using async/await or promise)</span>\ndoSomething1(arg1, arg2, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n  doSomething2(arg1, arg2, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    doSomething3(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-comment\">// done</span>\n    });\n  });\n});\nsomethingElse();\n</code></pre>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">//golang</span>\n<span class=\"hljs-keyword\">go</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">func</span><span class=\"hljs-params\">()</span></span> {\n  doSomething1(arg1, arg2)\n  doSomething2(arg1, arg2)\n  doSomething3()\n  <span class=\"hljs-comment\">// done</span>\n}()\nsomethingElse()\n</code></pre>\n</li>\n<li>\n<p>Faster startup time and light weight than threads = run more, run faster</p>\n</li>\n</ul>\n","postedAt":"19 Sep, 2015","metaDescription":"A goroutine is a lightweight thread managed by the Go runtime to support concurrency. It is considered a better mechanism than nodejs event event loop or normal thread.\n"}